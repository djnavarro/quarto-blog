---
title: "Playing with p5"
author:
  - name: Danielle Navarro
    url: https://djnavarro.net
    affiliation: I'm on smoko
    affiliation-url: https://www.youtube.com/watch?v=j58V2vC9EPc
    orcid: 0000-0001-7648-6578
description: "Because I can"
date: "2023-01-14"
categories: [Art, P5, Observable, Javascript]
image: linear.jpg
---

<!--------------- my typical setup ----------------->

```{r setup, include=FALSE}
set.seed(8)
long_slug <- "2023-01-14_p5js"
wide <- 136
narrow <- 76
options(width = narrow)
```

<!--------------- post begins here ----------------->


## Enabling p5js

The p5 library doesn't come bundled with observable, so we'll need to import it. As noted in the [quarto documentation on observable integration](https://quarto.org/docs/interactive/ojs/libraries.html#modules) this is as simple as using `require()` to import [NPM modules](https://docs.npmjs.com/about-packages-and-modules) using the [jsDelivr CDN](https://www.jsdelivr.com/):

```{ojs}
P5 = require("p5")
```

Now we'll use a trick I learned from [this fabulous notebook by Tom MacWright](https://observablehq.com/@tmcw/p5). We'll define  `p5()` as a [generator function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*):

```{ojs}
function* p5_sketch(sketch) {
  const element = DOM.element('div');
  yield element;
  const instance = new P5(sketch, element, true);
  try {
    while (true) {
      yield element;
    }
  } finally {
    instance.remove();
  }
}
```


## Example 1

Adaptation of this example: [observablehq.com/@tmcw/p5](https://observablehq.com/@tmcw/p5)

```{css}
@import url(https://fonts.googleapis.com/css?family=Courgette);
```

```{ojs}
//| column: page
p5_sketch(s => {
  
    s.setup = function() {
      s.createCanvas(1300, 300);
      s.textFont('Courgette');
      s.textStyle(s.BOLD);
      s.textAlign(s.CENTER, s.CENTER)
    };
    
    s.draw = function() {
      s.translate(
        s.millis() * (-0.1) % (s.width + 800), 
        s.height / 2
      );
      s.background('#222222');
      s.fill('#DC3F74').textSize(100);
      s.text('Hello Cruel World', s.width + 400, 0);
    };
    
  }
)
```



## Example 2

Example adapted from the generative art course by Bernat Ferragut: [ga-course.surge.sh](https://ga-course.surge.sh/)


```{ojs}  
//| column: page
p5_sketch(s => {

  let n = 100;
  let dot;
  let dotList = [];
  let palette = [
    s.color("#6B1B00"),
    s.color("#AE8B70"),
    s.color("#F9FEFB"),
    s.color("#56382D") 
  ];

  s.setup = function() {
    s.createCanvas(1300, 480);
    for(let i = 0; i < n; i++) {
      dotList.push(dot = new Dot(
        s,
        s.random(s.width),
        s.random(s.height),
        s.random(palette),
        s.random(1, 5)
      ));
    }
  };
    
  s.draw = function() {
    dotList.map(dot => {
      dot.on();
      dot.move();
    });
  };
})

```

where

```{ojs}
class Dot {
  constructor(sketch, x, y, colour, size) {
    this.s = sketch;
    this.x = x | 0;
    this.y = y | 0;
    this.colour = colour;
    this.size = size;
    this.velX = this.s.random(-2, 2);
    this.velY = this.s.random(-2, 2);
  }

  on() {
    this.s.noStroke();
    this.s.fill(this.colour);
    this.s.circle(this.x, this.y, this.size);
  }

  move() {
    this.x += this.velX;
    this.y += this.velY;
    if (this.x < 0 || this.x > this.s.width) {
      this.velX = -this.velX;
    }
    if (this.y < 0 || this.y > this.s.height) {
      this.velY = -this.velY;
    }
  }
}
```


## Example 3


```{ojs}
//| column: page
p5_sketch(s => {

  s.setup = function() {
    s.createCanvas(1300, 1300, s.WEBGL);
  }

  s.draw = function() {

    s. background(0);

    let locX = s.mouseX - s.height / 2;
    let locY = s.mouseY - s.width / 2;  
    
    s.ambientLight(60, 60, 60);
    s.pointLight(255, 255, 255, locX, locY, 100);
  
    s.specularMaterial(250);
    s.fill(250, 0, 0);
    s.rotateX(s.frameCount * 0.01);
    s.rotateY(s.frameCount * 0.01);
    s.torus(300, 150, 64, 64);
  }

})
```

<!--------------- appendices go here ----------------->
